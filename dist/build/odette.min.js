!function(n){var r=n.Odette=n.Odette||function(n,t,i,e,o){"use strict";function s(n,r){return this.SCOPED=y,this.CREATED_AT=V(),this.VERSION=n,this.application=this,this.missedDefinitions=[],this}var u,a=r.VERSION="0.0.0",c="",f="length",d="global",p="prototype",h=".",l=this||window||this,v=l.document,y=!0,g=!1,E=null,b=function(){},O=function(n){return function(r){return typeof r===n}},V=function(){return+new Date},w=function(n,r){for(var t=0,i=n[f],e=[];i>t;)e[t]=r(n[t],t,n),t++;return e},m=O("string"),x=O("number"),S=O("function"),L=O("object"),R=V(),C=function(n,r){return function(){return r.apply(n,arguments)}},D=function(n,r,t){var i,e=E;try{i=n()}catch(o){e=o,i=r?r(o,i):i}finally{i=t?t(e,i):i}return i},A=function(n,r){var t,i,e,o=T(n),s=T(r);return o===y?o:s===y?s:o===g&&s===g?(t=n.split(h),i=r.split(h),w(t,function(n,r){+n<+(i[r]||0)&&(e=y)}),e===u&&i[f]>t[f]&&(e=y),e?r:n):n>r?n:r},T=function(n){var r,t=n;return x(t)?t:(t+=c,r=+t,r===r?r:1===t.split(h)[f])},H=function(n){throw new Error(n)};s[p].exception=H,s[p].destroy=b,s[p].wraptry=D,s[p].now=V,s[p].extend=function(n){var r,t=this;for(r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t},s[p].undefine=function(n){return this.missedDefinitions.push(n),this.defining&&n.apply(this,[this,this.definingAgainst,this.definingWith]),this},s[p].parody=function(n){for(var r=this,t=0,i={},e=r[d];t<n[f];t++)i[n[t]]=C(e,e[n[t]]);return r.extend(i),r},s[p].scope=function(n,r){var t=n&&m(n)?n:this.VERSION,i=n&&(S(n)?n:S(r)?r:E);return this[d].scope(t,i)},s[p].counter=function(n){return r.counter(n)},s[p].libraryUrl=function(){return"./library.js"},s[p].loadLibrary=function(n){return this[d].loadLibrary(this,this.libraryUrl(),n)};var I,N=l[t]=l[t]||function(){return r.where.push(t),{Application:s,EXECUTED_AT:R,WHERE:t,VERSION:a,SHARED:y,SCOPED:g,versionOrder:[],versions:{},wraptry:D,maxVersion:A,map:w,registerVersion:function(n,r){var t=this,i=t.versions[n],e=t.versions[n]=i||r||new s(n,t);return e[d]=t,t.currentVersion=n,t.defaultVersion=t.maxVersion(t.defaultVersion,n)?n:t.defaultVersion,i||t.versionOrder.push(n),e},definition:function(n,r,t){var i,e,o,s,u,a=this,c=n,f=r,d=t;return L(c)&&(d=f,f=c,c=a.scope().VERSION),i=a.registerVersion(c),e=f.Odette,(o=e.options)?(u=f||o.context,s=d||{},i.defined?a.map(i.missedDefinitions,function(n){n.apply(i,[i,u,s])}):(i.defined=y,i.defining=y,i.definingAgainst=u,i.definingWith=s,o.handler.apply(i,[i,u,s]),i.defining=g,delete e.options),i):i},unRegisterVersion:function(n){var r=this,t=r.versions[n],i=r.versionOrder.indexOf(n);return-1===i?r:(t.destroy(),r.versionOrder.splice(i,1),t[d]=u,r.versions[n]=u,t)},scope:function(n,r){var t,i,e,o=this,s=o.versions;return m(n)||x(n)?(t=n,i=r):(i=n,t=o.defaultVersion),s[t]?o.currentVersion=t:o.registerVersion(t),e=s[t],S(i)?(i.apply(o,[e]),e):e},registerScopedMethod:function(n,r){var t=this,i=r||3;t[n]=t[n]||function(){var r=0,e=arguments,o=e,s=e[f],u=e[0];if(i>s)u=t.currentVersion;else{for(o=[];r<e[f];r++)o.push(e[r]);u=o.shift()}t.applyTo(u,n,o)};return t},get:function(n){return this.versions[n]},applyTo:function(n,r,t){var i=this,e=i.get(n);return e&&e[r]&&e[r].apply(e,t)},getCurrentScript:function(n){var r=(n||v).scripts,t=n.currentScript,i=r[r[f]-1];return t||i},touch:function(n,r,i){var e=this,o=e;return D(function(){var n=r.document;return o=r&&r[t]||o,!!n},function(){return g})?(r[t]=o,-1===r.Odette.where.indexOf(o.WHERE)&&r.Odette.where.push(o.WHERE),i||n[t]===o||(n[t]=o,w(e.versionOrder,function(n){o.registerVersion(n,e.versions[n])})),o):void 0},makeScript:function(n,r,t,i){var e=t||v,o=e.createElement("script");return o.type="text/javascript",i||e.head.appendChild(o),n&&(r&&(o.onload=r),m(n)?o.src=n:o.innerHTML=n.join("\n")),o},waitingForLibrary:[],loadLibrary:function(n,r,t){var i,e,o=n,u=this;if(m(n)&&(o=u.get(n)),o||s[p].exception("Application must have been created already."),u.defined)return t&&t(o);if(u.loadingLibrary)u.waitingForLibrary.push({app:o,context:buildContext,handler:function(n){t(n)}});else{if(!m(r))return e=u.definition(r),o=t&&t(o),e;u.loadingLibrary=y,i=u.buildContext,u.makeScript(r,function(){var n=u.waitingForLibrary;u.loadingLibrary=g,u.waitingForLibrary=[],u.map(n,function(n){return u.definition(n.context),n.handler&&n.handler(n.app)})},i.document)}}}}();return N.buildContext=n,I=N.get(i),I||(I=N.registerVersion(i),e.apply(l,[N,I])),o&&o.apply(l,[N,I]),I};r.where=r.where||[],r.counter=r.counter||function(){var n={},r=0;return function(t){var i;return t?(n[t]=n[t]||0,++n[t],i=n[t]):(++r,i=r),t?t+i:i}}(),r.definition=r.definition||function(n,r){this.options={context:n,handler:r}}}(this);