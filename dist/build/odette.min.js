!function(n,e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():n.Odette=t()}(this,"Odette",function(n){"use strict";var e,t="0.0.0",i="",r="definitions cannot fail due to errors",o="length",u="global",s="prototype",c=".",f=this||window,a=f.document,d=!0,p=!1,h=null,l=function(){},v=function(n){return function(e){return typeof e===n}},g=function(){return+new Date},y=function(n,e){for(var t=0,i=n&&n.slice(0),r=i&&i[o],u=[];r>t;)u[t]=e(i[t],t,i),t++;return u},E=v("string"),O=v("number"),m=v("function"),V=v("object"),x=function(n){return Array.isArray(n)},A=g(),R=function(n,e){return function(){return e.apply(n,arguments)}},S=function(n,e,t){var i,r=h;try{i=n()}catch(o){r=o,i=e?e(o,i):i}finally{i=t?t(r,i):i}return i},w=function(n,t){var i,r,u,s=T(n),f=T(t);return s===d?d:f===d?d:s===p&&f===p?(i=n.split(c),r=t.split(c),y(i,function(n,e){+n<+(r[e]||0)&&(u=d)}),1===i[o]&&3===r[o]?d:3===i[o]&&1===r[o]?p:(u===e&&r[o]>i[o]&&(u=d),!!u)):t>=n},C=function(n){return function(){return n}},D=function(n){var t=n.url,i=[];return V(n)?(b(n.query,function(n,t){n!==e&&(n=encodeURIComponent(stringify(n)),i.push(t+"="+n))}),i[o]&&(t+="?"),t+=i.join("&"),n.hash&&(n.hash=V(n.hash)?encodeURI(stringify(n.hash)):hash,t+="#"+n.hash)):t=n,t},T=function(n){var e,t=n;return O(t)?t:(t+=i,e=+t,e===e?e:1===t.split(c)[o])},I=function(n){var e,t,r,u,s,c=0,a=n,h=f.decodeURIComponent;for(E(a)||(a=a[LOCATION].search),"?"===a[0]&&(a=a.slice(1)),r=a.split("&"),e={};c<r[o];c++)t=r[c].split("="),t[0]&&(t[o]<2&&t[PUSH](i),u=t[1],u=h(u),"'"!==u[0]&&'"'!==u[0]||(u=u.slice(1,u[o]-1)),u===d+i&&(u=d),u===p+i&&(u=p),E(u)&&(s=+u,s==u&&s+i===u&&(u=s)),e[h(t[0])]=u);return e},N=function(n){throw new Error(n)},b=function(n,e,t){var i,r,o=n;if(V(o))if(x(o))y(o,e);else{r=[];for(i in o)o.hasOwnProperty(i)&&r.push(i);y(r,function(n){e.apply(t||this,[o[n],n,o])})}return o},H=function(n,e){return b(e,function(e,t){n[t]=e}),n},W=function(n){return S(function(){var e=n.document;return!!e},function(){return p})},q=[];return H(function(n,i,c,v,x,T){function j(n,e){return this.SCOPED=d,this.CREATED_AT=g(),this.VERSION=n,this.application=this,this.missedDefinitions=[],this.definedAgainst=[],this}j[s].extend=function(n){return this.merge(this,n)},j[s].merge=H,j[s].each=b,j[s].extend({exception:N,destroy:l,wraptry:S,now:g,stringifyQuery:D,parseSearch:I,undefine:function(n){return this.missedDefinitions.push(n),this.defining&&n.apply(this,[this,this.definingAgainst,this.definingWith]),this},parody:function(n){for(var e=this,t=0,i={},r=e[u];t<n[o];t++)i[n[t]]=R(r,r[n[t]]);return e.extend(i),e},scope:function(n,e){var t=n&&E(n)?n:this.VERSION,i=n&&(m(n)?n:m(e)?e:h);return this[u].scope(t,i)},counter:function(n){return Odette.counter(n)},definition:function(n,e){var t,i,o,u=this;return u.definedAgainst.indexOf(n)>-1?u:(u.definedAgainst.push(n),t=n.Odette,o=e||{},u.defined?y(u.missedDefinitions,function(e){e.apply(u,[u,n,o])}):(i=q.slice(0),q=[],y(i,function(e){u.defining&&N(r),u.defining=d,u.definingAgainst=n,u.definingWith=o,S(function(){e.handler.apply(u,[u,n,o]),u.defining=p,u.defined=d})})),u.defining&&N(r),u)}});var U=function(n,e){var t={};return function(i){var r,o=i||l,u=n,s=this,c=this.global,f=c.buildContext,a=function(){r.queue.push(h)},h={app:s,context:f,handler:o};return E(u)&&(u=C(u)),(u=u(s))?(r=t[u]=t[u]||{},r.finished?(e.apply(c,[h]),o.apply(h,[s])):r.loading?a():(r.queue=[],r.loading=d,a(),c.makeScript(u,function(){var n=r.queue.slice(0);r.loading=p,r.finished=d,r.queue=[],c.registerVersion(s.VERSION),c.map(n,function(n){e.apply(c,[n]),n.handler(n.app)})},f.document)),r.queue):p}};S(function(){var n;y(T,function(e){!f[i]&&W(e)&&e[i]&&(n=d,f[i]=e[i])})});var L,P=[],_=f[i]=f[i]||function(){return Odette.where.push(i),{Application:j,LOADED_CONTEXT:window,EXECUTED_AT:A,WHERE:i,VERSION:t,SHARED:d,SCOPED:p,versionOrder:[],versions:{},wraptry:S,maxVersion:w,map:y,loadScriptWithQueue:U,loadedAgainst:[n],queue:function(n,e){return P.push({context:n,handler:e}),this},emptyQueue:function(n){var e=P.slice(0),t=this,i=t.scope();return P=[],y(e,n||function(n){n.handler.apply(n.context,[t,i])}),t},registerVersion:function(n,e){var t=this,i=t.versions[n],r=t.versions[n]=i||e||new j(n,t);return r[u]=t,t.currentVersion=n,t.defaultVersion=t.maxVersion(t.defaultVersion,n)?n:t.defaultVersion,i||t.versionOrder.push(n),r},definition:function(n,e,t){var i,r=this,o=n,u=e,s=t;return V(o)&&(s=u,u=o,o=r.scope().VERSION),i=r.registerVersion(o),i.definition(u,s)},unRegisterVersion:function(n){var t=this,i=t.versions[n],r=t.versionOrder.indexOf(n);return-1===r?t:(i.destroy(),t.versionOrder.splice(r,1),i[u]=e,t.versions[n]=e,i)},scope:function(n,e){var t,i,r,o=this,u=o.versions;return E(n)||O(n)?(t=n,i=e):(i=n,t=o.defaultVersion),u[t]?o.currentVersion=t:o.registerVersion(t),r=u[t],m(i)?(i.apply(o,[r]),r):r},hoist:function(n,e){var t=this,i=e||window;return n?n===this.LOADED_CONTEXT?d:t.loadedAgainst.indexOf(n)+1?d:t.touch(n)?(n[t.WHERE]&&(i[t.WHERE]=n[t.WHERE]),i[t.WHERE]):p:p},registerScopedMethod:function(n,e){var t=this,i=e||3;t[n]=t[n]||function(){var e=0,r=arguments,u=r,s=r[o],c=r[0];if(i>s)c=t.currentVersion;else{for(u=[];e<r[o];e++)u.push(r[e]);c=u.shift()}t.applyTo(c,n,u)};return t},get:function(n){return this.versions[n]},applyTo:function(n,e,t){var i=this,r=i.get(n);return r&&r[e]&&r[e].apply(r,t)},getCurrentScript:function(n){var e=(n||a).scripts,t=n.currentScript,i=e[e[o]-1];return t||i},touch:W,makeScript:function(n,e,t,i){var r=t||a,o=r.createElement("script");return o.type="text/javascript",i||r.head.appendChild(o),n&&(e&&(o.onload=e),E(n)?o.src=n:o.innerHTML=n.join("\n")),o}}}();return _.buildContext=n,L=_.get(c),L||(L=_.registerVersion(c),v.apply(f,[_,L])),x&&x.apply(f,[_,L]),L},{VERSION:t,where:[],touchable:W,counter:function(){var n={},e=0;return function(t){var i;return t?(n[t]=n[t]||0,++n[t],i=n[t]):(++e,i=e),t?t+i:i}}(),definition:function(n,e){q.push({context:n,handler:e})}})});